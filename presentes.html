<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lista de Presentes - Caroline & Everton</title>

  <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />

  <style>
    /* Reusa o .gifts-wrapper mas for√ßa um layout de grid */
    .gifts-wrapper {
      display: grid !important; /* For√ßa o grid */
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px !important;
      overflow-x: hidden !important; /* Tira o scroll horizontal */
      padding-bottom: 20px !important;
    }

    /* O CSS do .gift-card vir√° do style.css (Passo 1) */
    .gift-card {
      min-height: 420px; /* Mant√©m a altura consistente */
    }

    /* Esconde as setas de navega√ß√£o nesta p√°gina */
    .gift-nav {
      display: none;
    }
  </style>
  <style>
  /* Trilho horizontal dos presentes */
  #presentes .gifts-wrapper{
    display:grid !important;
    grid-auto-flow:column !important;
    grid-auto-columns:minmax(300px,320px) !important; /* largura uniforme */
    gap:20px !important;
    overflow-x:auto !important;
    padding:8px 8px 16px !important;
    scroll-snap-type:x mandatory !important;
    align-items:stretch !important; /* alturas iguais */
  }

  /* Cart√£o de presente */
  #presentes .gift-card{
    display:flex !important;
    flex-direction:column !important;
    min-height:420px !important;              /* altura consistente */
    background:#fff;
    border:1px solid #eee4d6;
    border-radius:14px;
    box-shadow:0 6px 22px rgba(0,0,0,.05);
    padding:14px;
    scroll-snap-align:start;
  }

  /* Imagem padronizada */
  #presentes .gift-card img{
    width:100% !important;
    height:200px !important;
    object-fit:cover !important;              /* corta proporcional mantendo propor√ß√£o */
    border-radius:10px;
    margin-bottom:12px;
    display:block;
  }

  #presentes .gift-card h4{ margin:6px 0 4px; font-size:1.05rem; }
  #presentes .gift-card .valor{ color:#6b6b6b; font-size:.95rem; }

  /* Bot√£o sempre no rodap√© do cart√£o */
  #presentes .gift-card .btn{
    margin-top:auto !important;
    align-self:stretch;
    text-align:center;
  }

  /* Setas de navega√ß√£o */
  #presentes .gifts-area{ position:relative; }
  #presentes .gift-nav{
    position:absolute; top:50%; transform:translateY(-50%);
    z-index:2;
    background:#fff; border:1px solid #e7dccb;
    width:36px; height:36px; border-radius:999px;
    box-shadow:0 6px 16px rgba(0,0,0,.08);
    cursor:pointer;
  }
  #presentes .gift-prev{ left:-6px; }
  #presentes .gift-next{ right:-6px; }

  /* Scrollbar discreta do trilho */
  #carrossel-presentes::-webkit-scrollbar{ height:8px; }
  #carrossel-presentes::-webkit-scrollbar-thumb{ background:#e7dccb; border-radius:6px; }
  #carrossel-presentes{ scrollbar-color:#e7dccb transparent; scrollbar-width:thin; }
</style>
</head>
<body>

  <main class="conteudo">
    <section class="card">
      <h1 class="section-title">Lista de Presentes Completa</h1>
      <p><a href="index.html#presentes" style="font-weight: 600;">&larr; Voltar ao site principal</a></p>

      <div class="gifts-wrapper" id="presentes-grid-container">
        <p style="grid-column: 1 / -1;">Carregando presentes...</p>
      </div>
    </section>
  </main>

  <script src="script.js"></script>

  <script>
    // Roda assim que a p√°gina carregar
    document.addEventListener('DOMContentLoaded', () => {
      // Pega o container desta p√°gina
      const gridContainer = document.getElementById('presentes-grid-container');

      // Fun√ß√£o adaptada da 'carregarPresentes' do seu script.js
      async function carregarPresentesGrid() {
        try {
          gridContainer.innerHTML = "<p style='grid-column: 1 / -1;'>Carregando presentes...</p>";

          const data = await chamarJsonp(
            { acao: "presentesListar" },
            "callbackPresentesGrid" // Usa um callback diferente para n√£o conflitar
          );

          if (!data.ok) {
            gridContainer.innerHTML = "<p style='grid-column: 1 / -1;'>N√£o foi poss√≠vel carregar a lista de presentes.</p>";
            console.error(data.error);
            return;
          }

          const presentes = data.presentes || [];

          if (!presentes.length) {
            gridContainer.innerHTML = "<p style='grid-column: 1 / -1;'>Todos os presentes j√° foram escolhidos! üíù</p>";
            return;
          }

          gridContainer.innerHTML = ""; // Limpa o "Carregando..."

          presentes.forEach((p) => {
            const card = document.createElement("article");
            card.className = "gift-card"; // Reusa a classe .gift-card

            // Formata o valor (l√≥gica da nossa conversa anterior)
            let valorHtml = '';
            if (p.valor) {
              const valorNumerico = parseFloat(String(p.valor).replace(',', '.'));
              let valorFormatado = p.valor;
              if (!isNaN(valorNumerico)) {
                valorFormatado = valorNumerico.toLocaleString('pt-BR', {
                  minimumFractionDigits: 2,
                  maximumFractionDigits: 2
                });
              }
              valorHtml = `<p class="gift-value">Valor aproximado: <strong>R$ ${valorFormatado}</strong></p>`;
            }

            // Monta o card (mesmo HTML do script.js)
            card.innerHTML = `
              <div class="gift-image">
                ${p.foto ? `<img src="${p.foto}" alt="${p.item || "Presente"}" loading="lazy">` : ""}
              </div>
              <div class="gift-content">
                <h3>${p.item || "Presente"}</h3>
                ${valorHtml}
                <p class="gift-code">
                  C√≥digo do presente: <strong>${p.codigo}</strong>
                </p>
                <div class="gift-actions">
                  ${p.url ? `<a href="${p.url}" class="btn btn-light" target="_blank" rel="noopener">Abrir link</a>` : ""}
                </div>
              </div>
            `;
            gridContainer.appendChild(card);
          });

        } catch (err) {
          console.error(err);
          gridContainer.innerHTML = "<p style='grid-column: 1 / -1;'>Erro ao carregar a lista de presentes.</p>";
        }
      }

      // Executa a fun√ß√£o
      carregarPresentesGrid();
    });
  </script>

</body>
</html>
