<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <style>
  /* Reusa o .gifts-wrapper mas for칞a um layout de grid */
  .gifts-wrapper {
    display: grid !important; /* For칞a o grid */
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px !important;
    overflow-x: hidden !important; /* Tira o scroll horizontal */
    padding-bottom: 20px !important;
    align-items: stretch !important; /* alturas iguais */
  }

  /* Esconde as setas de navega칞칚o nesta p치gina */
  .gift-nav {
    display: none;
  }

  /* --- A CORRE칂츾O DE ALINHAMENTO --- */

  /* Cart칚o de presente */
  #presentes .gift-card, .gift-card {
    display: flex !important;
    flex-direction: column !important;
    min-height: 420px !important; /* altura consistente */
    background: #fff;
    border: 1px solid #eee4d6;
    border-radius: 14px;
    box-shadow: 0 6px 22px rgba(0,0,0,.05);
    padding: 14px;
  }

  /* Container da Imagem padronizado (para alinhar) */
  #presentes .gift-card .gift-image, .gift-card .gift-image {
    width: 100%;
    height: 200px; /* For칞a a altura do container */
    background: #faf8f5; /* Cor de fundo para espa칞os vazios */
    border: 1px dashed #e7dccb; /* Linha sutil para caixas vazias */
    border-radius: 10px;
    margin-bottom: 12px;
    display: block;
    position: relative;
  }

  /* Texto de placeholder para caixas vazias */
  #presentes .gift-card .gift-image:empty::before, .gift-card .gift-image:empty::before {
    content: "Foto n칚o dispon칤vel";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #b0a89d;
    font-size: 0.9rem;
    font-weight: 600;
  }

  /* Imagem (se existir) preenche o container */
  #presentes .gift-card .gift-image img, .gift-card .gift-image img {
    width: 100%;
    height: 100%; /* Preenche os 200px do pai */
    object-fit: cover !important;
    border-radius: 10px;
    display: block;
    border: none; /* Remove a borda pontilhada se a img existir */
  }

  /* Bot칚o sempre no rodap칠 do cart칚o */
  #presentes .gift-card .btn, .gift-card .btn {
    margin-top: auto !important;
    align-self: stretch;
    text-align: center;
  }

  /* T칤tulos e valores */
  #presentes .gift-card h4, .gift-card h4 { margin:6px 0 4px; font-size:1.05rem; }
  #presentes .gift-card .valor, .gift-card .valor { color:#6b6b6b; font-size:.95rem; }
</style>
</head>
<body>

  <main class="conteudo">
    <section class="card">
      <h1 class="section-title">Lista de Presentes Completa</h1>
      <p><a href="index.html#presentes" style="font-weight: 600;">&larr; Voltar ao site principal</a></p>

      <div class="gifts-wrapper" id="presentes-grid-container">
        <p style="grid-column: 1 / -1;">Carregando presentes...</p>
      </div>
    </section>
  </main>

  <script src="script.js"></script>

  <script>
    // Roda assim que a p치gina carregar
    document.addEventListener('DOMContentLoaded', () => {
      // Pega o container desta p치gina
      const gridContainer = document.getElementById('presentes-grid-container');

      // Fun칞칚o adaptada da 'carregarPresentes' do seu script.js
      async function carregarPresentesGrid() {
        try {
          gridContainer.innerHTML = "<p style='grid-column: 1 / -1;'>Carregando presentes...</p>";

          const data = await chamarJsonp(
            { acao: "presentesListar" },
            "callbackPresentesGrid" // Usa um callback diferente para n칚o conflitar
          );

          if (!data.ok) {
            gridContainer.innerHTML = "<p style='grid-column: 1 / -1;'>N칚o foi poss칤vel carregar a lista de presentes.</p>";
            console.error(data.error);
            return;
          }

          const presentes = data.presentes || [];

          if (!presentes.length) {
            gridContainer.innerHTML = "<p style='grid-column: 1 / -1;'>Todos os presentes j치 foram escolhidos! 游눟</p>";
            return;
          }

          gridContainer.innerHTML = ""; // Limpa o "Carregando..."

          presentes.forEach((p) => {
            const card = document.createElement("article");
            card.className = "gift-card"; // Reusa a classe .gift-card

            // Formata o valor (l칩gica da nossa conversa anterior)
            let valorHtml = '';
            if (p.valor) {
              const valorNumerico = parseFloat(String(p.valor).replace(',', '.'));
              let valorFormatado = p.valor;
              if (!isNaN(valorNumerico)) {
                valorFormatado = valorNumerico.toLocaleString('pt-BR', {
                  minimumFractionDigits: 2,
                  maximumFractionDigits: 2
                });
              }
              valorHtml = `<p class="gift-value">Valor aproximado: <strong>R$ ${valorFormatado}</strong></p>`;
            }

            // Monta o card (mesmo HTML do script.js)
            card.innerHTML = `
              <div class="gift-image">
                ${p.foto ? `<img src="${p.foto}" alt="${p.item || "Presente"}" loading="lazy">` : ""}
              </div>
              <div class="gift-content">
                <h3>${p.item || "Presente"}</h3>
                ${valorHtml}
                <p class="gift-code">
                  C칩digo do presente: <strong>${p.codigo}</strong>
                </p>
                <div class="gift-actions">
                  ${p.url ? `<a href="${p.url}" class="btn btn-light" target="_blank" rel="noopener">Abrir link</a>` : ""}
                </div>
              </div>
            `;
            gridContainer.appendChild(card);
          });

        } catch (err) {
          console.error(err);
          gridContainer.innerHTML = "<p style='grid-column: 1 / -1;'>Erro ao carregar a lista de presentes.</p>";
        }
      }

      // Executa a fun칞칚o
      carregarPresentesGrid();
    });
  </script>

</body>
</html>
